{"name":"Consol","tagline":"Micro framework for command line PHP apps","body":"# Consol — Micro framework for command line PHP apps\r\n\r\nConsol is a minimal and unopinionated micro framework for developing simple yet powerful command line apps and services that is easy to read and write, requires minimal prerequisite knowledge, has no dependencies and prefers common-case over edge-case solutions.\r\n\r\n## Hello, World!\r\n\r\n```php\r\n// app.php\r\n$app = new RichJenks\\Consol\\App;\r\n\r\n$app->map('hello', function () {\r\n    return 'Hello World';\r\n});\r\n\r\n```\r\n\r\n```bash\r\n# terminal\r\nphp app.php hello\r\n# Hello World\r\n```\r\n\r\n## Key Features\r\n\r\n- Routes terminal requests\r\n- Simplifies parameters and options\r\n- Generates command directory\r\n- Packages your app as a PHAR\r\n\r\n## Requirements\r\n\r\n- PHP >=5.5\r\n- Phar PHP extension\r\n- `phar.readonly = 0` in `/etc/php5/cli/php.ini`\r\n\r\n## Installation\r\n\r\nInstall via [Composer](https://getcomposer.org/) with `composer require richjenks/consol` or download and include it in your code with `require 'consol/App.php';`\r\n\r\n## Mapping Commands to Code\r\n\r\nA Consol app could look like this:\r\n\r\n```php\r\n#!/usr/local/bin/php\r\n<?php require 'vendor/autoload.php';\r\n\r\n$app->map('hello', function ($app) {\r\n    return 'Hello World';\r\n}, 'Say \"Hello\" to the World');\r\n\r\n$app->run();\r\n```\r\n\r\nCalling `php app.php hello` from the command line will run this command. The `map` function accepts 3 parameters:\r\n\r\n1. Command to trigger the route\r\n2. Callback to map to the command\r\n3. Optional description of the command\r\n\r\n> Commands can only contain alphanumerics, colons, hyphens and underscores.\r\n\r\n## Magic Commands\r\n\r\nMagic Commands are commands that are not included in the command map and are called by special events. There are 2 Magic Commands and they are:\r\n\r\n1. Colon (`:`) which represents when no command is issued (the root command)\r\n2. Question Mark (`?`) which represents an unknown command\r\n\r\nHere's an example of overriding the default unknown command handler:\r\n\r\n```php\r\n$app->map('?', function ($app) {\r\n    return $app->say('I have no idea what I\\'m doing...');\r\n});\r\n```\r\n\r\nBoth have default handlers which are overridden by mapping them to your own code. By default, the root command will show the Command Directory (which has its own section below) and unknown commands will display the text \"Unknown Command\" in red and may attempt to suggest an intended function in case of a typo via the `suggest()` function,  which is documented further down.\r\n\r\n## Using `$app`\r\n\r\nThe `$app` object is made available to your commands and it exposes a number of useful functions:\r\n\r\n### Say\r\n\r\nOutputs text to the console and should be used instead of `echo`, `print`, etc. because it outputs immediately (rather than at the end of the script) and allows responses to be edited by Middleware (which has its own section below). It accepts 2 parameters:\r\n\r\n1. The text to be output\r\n2. An optional color for the text\r\n\r\nAvailable colors are `aqua`, `black`, `blue`, `cyan`, `emerald`, `gray`, `lilac`, `green`, `maroon`, `navy`, `orange`, `purple`, `red`, `silver`, `white` and `yellow`.\r\n\r\nFor example: `$app->say('Oh hai!', 'green');`\r\n\r\n### Color\r\n\r\nIdentical to `say()` except it returns the text rather than outputting immediately.\r\n\r\n### Ask\r\n\r\nPrompt the user to provide information, for example:\r\n\r\n```php\r\n$name = ask('What is your name: ');\r\nsay(\"Hello, $name!\");\r\n```\r\n\r\nIt has three parameters but only the first is required:\r\n\r\n1. The text to display to the user\r\n2. Default value if user enters nothing (or `null` for no default value)\r\n3. Regular Expression against which the value is checked\r\n\r\n> Providing `null` as the default value means that no default value will be considered — it does not mean it will return `null` if no value is provided.\r\n\r\nHere's a more practical example:\r\n\r\n```php\r\n$name = $app->ask('What is your name: ', null, '.+');\r\n$app->say(\"Hello, $name!\");\r\n```\r\n\r\nThe above example will prompt the user for their name, but if none is given then it will ask again. The answer must be at least one character. `ask` isn't very clever, so you are free to define whatever logic you like.\r\n\r\nOr to ask for confirmation:\r\n\r\n```php\r\n$sure = $app->ask('Are you sure? [y/n] ', 'n', 'y|n');\r\n$app->say(($sure === 'y') ? 'You are sure' : 'You are unsure');\r\n```\r\n\r\nHere are a few example regular expressions for common requirements:\r\n\r\n- `.*`  Accept anything, including empty values\r\n- `.+` Accept anything, must be at least one character\r\n- `y|n` Accepts anything containing \"y\", \"n\" (basic confirmation)\r\n- `^yes$|^no$|^maybe$` Accepts only \"yes\", \"no\" or \"maybe\"\r\n\r\n> Neither validation rules nor default values are shown to the user — you are free to provide whatever information you wish in the first \"question\" parameter.\r\n\r\n### Progress\r\n\r\nShows a progress bar to the user and accepts two values: current progress and total. For example:\r\n\r\n```php\r\n$app->say('Progressing...' . PHP_EOL);\r\n$progress = 0;\r\nwhile ($progress <= 70) {\r\n    $app->progress($progress, 70);\r\n    $progress += 3;\r\n    sleep(1);\r\n}\r\n$app->progress(70, 70);\r\n$app->say(PHP_EOL . 'Progress complete' . PHP_EOL);\r\n```\r\n\r\n### Table\r\n### Suggest\r\n### Get Request\r\n\r\nThis is a testing function that can be used to analyse the request. It returns an array with the keys `command`, `params`, `options` and `map`:\r\n\r\n```php\r\nvar_dump($app->get_request());\r\n//\r\n```\r\n\r\nThe `param()` and `option()` functions are preferred as they integrate will middleware and are generally \"nicer\" from a syntax perspective.\r\n\r\n## Command Directory\r\n\r\nWhen mapping commands to callbacks, the `$app->map()` function accepts an optional third argument: a description of the command. This is used to construct a directory of available commands that is shown by the default handler for the root command and it looks like this:\r\n\r\n```\r\nCommands:\r\n  hello   Say \"Hello\" to the World\r\n\r\n```\r\n\r\nThe directory makes use of the `table()` function (documented below) to output tabular data and it can also be shown manually by returning `$app->directory()` from within a command's callback:\r\n\r\n```php\r\n$app->map('directory', function ($app) {\r\n    $app->say($app->directory());\r\n});\r\n```\r\n\r\n## Parameters\r\n\r\nData can be retrieved from the command line in the form of parameters. For example, running `php app.php hello World` will return `Hello World`. `$app->param()` can be used to get the value of a parameter in a one-indexed fashion — zero contains the command, which in this case is `hello`.\r\n\r\nFor example, to say hello in the color of your choosing, you could register the following command:\r\n\r\n```php\r\n$app->map('hello', function ($app) {\r\n    return $app->say(\r\n        'Hello ' . $app->param(1),\r\n        $app->param(2)\r\n    );\r\n});\r\n```\r\n\r\nand then call:\r\n\r\n```bash\r\nphp app.php hello World blue\r\n# Outputs \"Hello World\" in blue\r\n```\r\n\r\n## Options\r\n\r\nOptions are similar to Parameters but are prepended by two hyphens, e.g. `--foo`, and can optionally provide values, e.g. `--foo=bar`. They can be at any position in the command line call but are ignored by the indexing of parameters. For example, if you call `php app.php foo --fizzbuzz bar` then `foo` will still be parameter one and `bar` will still be parameter two.\r\n\r\n> No options are sacred to a Consol app — for example, there is no concept of verbosity and no options are reserved, so you are free to implement any options you like!\r\n\r\nThe two types of options are *Flag* and *Value* options:\r\n\r\n### Flags\r\n\r\nFlags are `true` when present and `false` when omitted:\r\n\r\n```php\r\n$app->map('hello', function ($app) {\r\n    $greeting = 'Hello ' . $app->param(1);\r\n    if ($app->option('yell')) $greeting = strtoupper($greeting);\r\n    return $app->say($greeting);\r\n});\r\n```\r\n\r\n```bash\r\nphp app.php hello World --yell\r\n# Outputs \"HELLO WORLD\"\r\n```\r\n\r\nFlag options can also be passed in short form (e.g. `-yv`) and you can check for the presence of multiple flags to facilitate this, e.g. `if ($app->option('y', 'yell')) { ... }`. No link exists between short and long options so you are free to define any combination you wish by use of the `option()` function.\r\n\r\n### Values\r\n\r\nValues hold strings when present and are `false` when omitted:\r\n\r\n```php\r\n$app->map('hello', function ($app) {\r\n    $greeting = 'Hello ' . $app->param(1);\r\n    if (is_string($app->option('from')))\r\n        $greeting .= ', from ' . $app->option('from');\r\n    return $app->say($greeting);\r\n});\r\n```\r\n\r\n```bash\r\nphp app.php hello World --from=Moon\r\n# Outputs \"Hello World, from Moon\"\r\n```\r\n\r\nNote that Consol can't distinguish between a flag option and an empty value option, so `is_string()` should be used to check for the presence of a value option. Absent value options return `false` like an omitted flag option.\r\n\r\n## Middleware\r\n\r\nMiddleware allows you to edit a request before it is routed through the map and the response output before it is shown to the console. Middleware in console applications is not as important as with web applications because of the proportion of things happening in the background and things visible to the user, but it is still a useful tool that allows multiple commands to be edited by the same filter(s).","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}